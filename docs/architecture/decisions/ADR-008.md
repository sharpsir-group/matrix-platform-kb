# ADR-008: Why 5-level scope hierarchy over simpler RBAC

## Status

Accepted

## Context

The platform serves a luxury brokerage with brokers, team leads, directors, and C-suite. Data visibility requirements vary:

- Brokers: own listings and contacts
- Team leads: team-level visibility
- Directors: market or office-level
- C-suite: organization-wide

Simple role-based access (e.g., admin vs. user) is insufficient for team-level data visibility and compliance.

## Decision

Implement a **5-level scope hierarchy** with CRUD permission strings:

1. **self**: Own resources only
2. **team**: Own + team members' resources
3. **global**: Organization-wide read (or write where permitted)
4. **org_admin**: Administrative scope within organization
5. **system_admin**: Cross-organization, platform-level

Each permission is a string (e.g., `listings:team:read`, `contacts:global:write`). RLS policies read scope from JWT claims. 23 predefined roles map to scope + permission combinations.

## Consequences

**Positive**

- Fine-grained data visibility aligned with brokerage structure
- Team-aware queries in RLS (e.g., `team_id` in JWT)
- Supports compliance and audit requirements
- Flexible enough for future role changes without schema changes

**Negative**

- More complex JWT claims structure
- RLS policies must be carefully written and tested for each scope level
- Role management UI and documentation must explain the hierarchy clearly
